<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Контакты</title>
    <link rel="stylesheet" href="../style/styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="header">
        <div class="container">
          <div class="header__content">
            <h1 class="header__title">Телегина Алёна</h1>
            <p class="header__subtitle">Студент-разработчик</p>
          </div>
        </div>
      </header>
      <nav class="nav">
        <div class="container">
          <ul>
            <li class="nav__item">
              <a href="../index.html" class="nav-link">Главная</a>
            </li>
            <li class="nav__item">
              <a href="projects.html" class="nav-link">Проекты</a>
            </li>
            <li class="nav__item">
              <a href="diary.html" class="nav-link">Дневник</a>
            </li>
            <li class="nav__item--active">
              <a href="contacts.html" class="nav-link" aria-current="page"
                >Контакты</a
              >
            </li>
          </ul>
        </div>
      </nav>
      <main class="main">
        <div class="container">
          <!-- Добавлен живой регион для уведомлений -->
          <div
            id="live-region"
            aria-live="polite"
            aria-atomic="true"
            class="sr-only"
          ></div>

          <h1 class="contact-info__title">Свяжитесь со мной</h1>

          <section aria-labelledby="form-title">
            <h2 id="form-title" class="sr-only">Форма обратной связи</h2>
            <form id="feedbackForm" action="/submit-form" class="form">
              <fieldset>
                <legend class="legend">Контактная информация</legend>

                <div class="form-group">
                  <label class="form-label" for="name">
                    Имя:<span class="required" aria-hidden="true">*</span>
                  </label>
                  <input
                    class="form-input"
                    type="text"
                    id="name"
                    name="name"
                    required
                    aria-required="true"
                    placeholder="Иван"
                    aria-describedby="name-hint"
                  />
                  <span id="name-hint" class="form-hint"
                    >Обязательное поле</span
                  >
                </div>

                <div class="form-group">
                  <label class="form-label" for="email">
                    Email:<span class="required" aria-hidden="true">*</span>
                  </label>
                  <input
                    class="form-input"
                    type="email"
                    id="email"
                    name="email"
                    required
                    aria-required="true"
                    placeholder="example@mail.ru"
                    aria-describedby="email-hint"
                  />
                  <span id="email-hint" class="form-hint"
                    >Обязательное поле</span
                  >
                </div>

                <div class="form-group">
                  <label class="form-label" for="message">
                    Сообщение:<span class="required" aria-hidden="true">*</span>
                  </label>
                  <textarea
                    class="form__textarea"
                    id="message"
                    name="message"
                    required
                    aria-required="true"
                    placeholder="Опишите вашу проблему или вопрос..."
                    aria-describedby="message-hint"
                  ></textarea>
                  <span id="message-hint" class="form-hint"
                    >Обязательное поле</span
                  >
                </div>
              </fieldset>

              <button type="submit" class="button" onclick="submitForm(event)">
                Отправить сообщение
              </button>
            </form>
          </section>

          <section aria-labelledby="contacts-title">
            <h2 id="contacts-title" class="contact-info__title">Контакты</h2>
            <div class="contact-info__items">
              <p class="contact-item">Email: telegina.a.i@edu.mirea.ru</p>
              <p class="contact-item">GitHub: telegina-alena</p>
              <p class="contact-item">Москва, Россия</p>
            </div>
          </section>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="footer__content">
            <p class="footer__copyright">&copy; 2025 StudentDev Portfolio</p>
            <div class="footer__links">
              <a href="mailto:telegina.a.i@edu.mirea.ru" class="footer__link">
                telegina.a.i@edu.mirea.ru
              </a>
              <a href="https://github.com/telegina-alena" class="footer__link"
                >GitHub</a
              >
            </div>
          </div>
        </div>
      </footer>

      <script>
        // Функция для отправки формы
        function submitForm(event) {
          event.preventDefault();
          const form = document.getElementById("feedbackForm");
          const formData = new FormData(form);
          const liveRegion = document.getElementById("live-region");

          // Валидация формы
          if (!form.checkValidity()) {
            // Помечаем невалидные поля
            const fields = form.querySelectorAll("input, textarea");
            fields.forEach((field) => {
              if (!field.validity.valid) {
                field.setAttribute("aria-invalid", "true");
                // Создаем или обновляем описание ошибки
                let errorId = field.id + "-error";
                let errorElement = document.getElementById(errorId);
                if (!errorElement) {
                  errorElement = document.createElement("span");
                  errorElement.id = errorId;
                  errorElement.className = "error-message";
                  errorElement.textContent =
                    "Это поле обязательно для заполнения";
                  field.parentNode.appendChild(errorElement);
                }
                field.setAttribute(
                  "aria-describedby",
                  field.getAttribute("aria-describedby") + " " + errorId
                );
              } else {
                field.setAttribute("aria-invalid", "false");
                // Удаляем сообщения об ошибках
                let errorId = field.id + "-error";
                let errorElement = document.getElementById(errorId);
                if (errorElement) {
                  errorElement.remove();
                }
              }
            });

            // Сообщение для скринридеров
            liveRegion.textContent =
              "В форме есть ошибки. Пожалуйста, проверьте обязательные поля.";
            return;
          }

          // Собираем данные формы
          const data = {
            name: formData.get("name"),
            email: formData.get("email"),
            message: formData.get("message"),
          };

          // В реальном приложении здесь был бы AJAX-запрос
          console.log("Данные формы:", data);

          // Сообщение об успешной отправке для скринридеров
          liveRegion.textContent =
            "Спасибо! Ваше обращение отправлено. Мы свяжемся с вами в ближайшее время.";

          // Визуальное уведомление
          alert(
            "Спасибо! Ваше обращение отправлено. Мы свяжемся с вами в ближайшее время."
          );

          // Сброс формы
          form.reset();

          // Сброс состояний доступности
          const fields = form.querySelectorAll("input, textarea");
          fields.forEach((field) => {
            field.setAttribute("aria-invalid", "false");
          });
        }

        // Обработчик клавиатуры для формы
        document.addEventListener("keydown", function (event) {
          if (event.key === "Escape") {
            // Закрытие модальных окон (если бы они были)
            console.log("Escape pressed - close modals if any");
          }
        });
      </script>
    </div>
  </body>
</html>
